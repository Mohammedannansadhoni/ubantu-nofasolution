<div class="row">
    <div class="col-md-8 col-md-offset-2">
        <h2>Manage Fonts</h2>
        {{#if hasErrors}}
            <div class="alert alert-danger">
                {{#each messages}}
                    <p>{{this}}</p>
                {{/each}}
            </div>
        {{else}}
            {{#if messages}}
                {{#each messages}}
                    <div class="alert alert-success">{{this}}</div>
                {{/each}}
            {{/if}}
        {{/if}}
        
        <form id="fontUploadForm" action="/event/manage-fonts" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="fontType">Font Type</label>
                <select class="form-control" id="fontType" name="fontType" required>
                    <option value="">Select Font Type</option>
                    <option value="google">Google Fonts API</option>
                    <option value="custom">Custom Font File</option>
                </select>
                <small class="form-text text-muted">Choose whether to add a Google Font or upload a custom font file.</small>
            </div>
            <div class="form-group">
                <label for="fontName">Font Name</label>
                <input type="text" class="form-control" id="fontName" name="fontName" required>
                <small class="form-text text-muted">Enter a display name for the font (e.g., "Roboto Bold", "My Custom Font").</small>
            </div>
            <div class="form-group" id="googleFontGroup" style="display:none;">
                <label for="fontApi">Google Fonts API Link</label>
                <input type="text" class="form-control" id="fontApi" name="fontApi" placeholder="https://fonts.googleapis.com/css?family=Roboto:400,700">
                <small class="form-text text-muted">
                    <strong>How to get Google Fonts API link:</strong><br>
                    1. Go to <a href="https://fonts.google.com" target="_blank">Google Fonts</a><br>
                    2. Select your font and styles<br>
                    3. Click "View selected families" in top right<br>
                    4. Copy the link from "&lt;link&gt;" section (starts with https://fonts.googleapis.com/css...)
                </small>
            </div>
            <div class="form-group" id="customFontGroup" style="display:none;">
                <label for="fontFile">Upload Font File</label>
                <input type="file" class="form-control" id="fontFile" name="fontFile" accept=".ttf,.woff,.woff2,.otf">
                <small class="form-text text-muted">
                    <strong>Supported formats:</strong> .ttf, .woff, .woff2, .otf<br>
                    Upload your custom font file. Make sure you have the right to use the font.
                </small>
            </div>
            <button type="submit" class="btn btn-success">Add Font</button>
        </form>
        <hr>
        <h3>Font Family List</h3>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Font Name</th>
                    <th>Type</th>
                    <th>Preview</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each fonts}}
                <tr>
                    <td>{{fontName}}</td>
                    <td>{{fontType}}</td>
                    <td>
                        {{#if googleFontApi}}
                            <link href="{{googleFontApi}}" rel="stylesheet">
                            <span style="font-family: '{{fontFamily}}', sans-serif; font-size: 18px;">Sample Text</span>
                        {{/if}}
                        {{#if fontFile}}
                            <style>
                                @font-face { 
                                    font-family: '{{fontFamily}}'; 
                                    src: url('/uploads/fonts/{{fontFile}}'); 
                                }
                            </style>
                            <span style="font-family: '{{fontFamily}}'; font-size: 18px;">Sample Text</span>
                        {{/if}}
                    </td>
                    <td>
                        <a href="/event/delete-font/{{_id}}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this font?')">Delete</a>
                    </td>
                </tr>
                {{/each}}
                {{#unless fonts}}
                <tr>
                    <td colspan="4" class="text-center">No custom fonts added yet</td>
                </tr>
                {{/unless}}
            </tbody>
        </table>
    </div>
</div>

<script>
$(document).ready(function() {
    $('#fontType').change(function() {
        var selectedType = $(this).val();
        
        if(selectedType === 'google') {
            $('#googleFontGroup').show();
            $('#customFontGroup').hide();
            $('#fontApi').prop('required', true);
            $('#fontFile').prop('required', false);
        } else if(selectedType === 'custom') {
            $('#googleFontGroup').hide();
            $('#customFontGroup').show();
            $('#fontApi').prop('required', false);
            $('#fontFile').prop('required', true);
        } else {
            $('#googleFontGroup').hide();
            $('#customFontGroup').hide();
            $('#fontApi').prop('required', false);
            $('#fontFile').prop('required', false);
        }
    });
});
</script>
